(this["webpackJsonpprimer-app"]=this["webpackJsonpprimer-app"]||[]).push([[0],{23:function(e,t,n){},27:function(e,t,n){},28:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var a=n(3),r=n.n(a),c=n(18),s=n.n(c),o=(n(23),n(4)),i=n.n(o),u=n(8),l=n(10),j=n(6),p=n(15);n(35);p.a.initializeApp({apiKey:"AIzaSyB3eTixPwzFobVTrmom_vQpOnP3wZ5hkuA",authDomain:"react-chat-9e283.firebaseapp.com",databaseURL:"https://react-chat-9e283-default-rtdb.firebaseio.com",projectId:"react-chat-9e283",storageBucket:"react-chat-9e283.appspot.com",messagingSenderId:"178991264140",appId:"1:178991264140:web:bdfebce71e614ef73626a9"});var d=p.a.firestore();function b(e){return f.apply(this,arguments)}function f(){return(f=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,d.collection("messages").orderBy("date","asc").onSnapshot((function(e){var n=[];e.forEach((function(e){n.push(Object(j.a)({id:e.id},e.data()))})),t(n)})),e.next=8;break;case 4:throw e.prev=4,e.t0=e.catch(0),console.log(e.t0),new Error("Los mensajes no se pudieron cargar");case 8:case"end":return e.stop()}}),e,null,[[0,4]])})))).apply(this,arguments)}function h(e){return m.apply(this,arguments)}function m(){return(m=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.collection("messages").doc().set(t);case 3:e.next=9;break;case 5:throw e.prev=5,e.t0=e.catch(0),console.log(e.t0),new Error("El mensaje no se pudo enviar.");case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function O(e){return v.apply(this,arguments)}function v(){return(v=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.collection("users").doc().set(t);case 3:e.next=9;break;case 5:throw e.prev=5,e.t0=e.catch(0),console.log(e.t0),new Error("El usuario no se pudo registrar.");case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function x(e){return g.apply(this,arguments)}function g(){return(g=Object(u.a)(i.a.mark((function e(t){var n,a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,a=t.password,e.prev=1,e.next=4,d.collection("users").where("username","==",n).where("password","==",a).get();case 4:if(!(r=e.sent).docs[0]){e.next=9;break}return e.abrupt("return",Object(j.a)({id:r.docs[0].id},r.docs[0].data()));case 9:return e.abrupt("return",!1);case 10:e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(1),console.log(e.t0),new Error("El usuario no se pudo validar.");case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function w(e,t,n){return k.apply(this,arguments)}function k(){return(k=Object(u.a)(i.a.mark((function e(t,n,a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.collection("users").doc(t).update({nickname:n,color:a});case 3:e.next=9;break;case 5:throw e.prev=5,e.t0=e.catch(0),console.log(e.t0),new Error("No se pudieron guardar las preferencias.");case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}var N=n(1),y=Object(a.createContext)(),C=function(){return Object(a.useContext)(y)};function S(e){var t=e.children,n=Object(a.useState)(!0),r=Object(l.a)(n,2),c=r[0],s=r[1],o=Object(a.useState)([]),j=Object(l.a)(o,2),p=j[0],d=j[1],f=Object(a.useState)(""),m=Object(l.a)(f,2),O=m[0],v=m[1],x=function(){var e=Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b(d);case 3:setTimeout((function(){s(!1)}),500),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0),v(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(""),n={date:new Date,nickname:t.nickname,color:t.color,message:t.message},e.prev=2,e.next=5,h(n);case 5:v("Mensaje enviado"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0),v(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){x()}),[]),Object(N.jsx)(y.Provider,{value:{loadingMessages:c,messages:p,notification:O,setNotification:v,sendMessage:g},children:t})}var E=Object(a.createContext)(),D=function(){return Object(a.useContext)(E)};function P(e){var t=e.children,n=Object(a.useState)(""),r=Object(l.a)(n,2),c=r[0],s=r[1],o=Object(a.useState)(!1),p=Object(l.a)(o,2),d=p[0],b=p[1],f=Object(a.useState)({id:"",nickname:"",color:"white"}),h=Object(l.a)(f,2),m=h[0],v=h[1],g=function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(""),b(!1),e.prev=2,e.next=5,O(Object(j.a)(Object(j.a)({},t),{},{nickname:"",color:"white"}));case 5:s("Usuario creado. Logueate!"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),s(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(""),b(!1),e.prev=2,e.next=5,x(t);case 5:(n=e.sent)?(v({id:n.id,nickname:n.nickname,color:n.color}),b(!0),s("Has iniciado sesi\xf3n!")):s("Usuario o contrase\xf1a incorrecto/s."),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),s(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(u.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w(m.id,t,n);case 3:v({nickname:t,color:n}),s(""),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),s("No se pudieron guardar las preferencias.");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(N.jsx)(E.Provider,{value:{notification:c,setNotification:s,registerUser:g,loginUser:k,userLogged:d,userPrefs:m,logOutUser:function(){b(!1),v({id:"",nickname:"",color:"white"}),s("Ha cerrado sesi\xf3n.")},changeUserPrefs:y},children:t})}var U=n(13);n(27);function F(){var e=D(),t=e.registerUser,n=e.loginUser,r=e.notification,c=e.setNotification,s=Object(a.useState)({username:"",password:""}),o=Object(l.a)(s,2),i=o[0],u=o[1],p=function(e){var t=e.target,n=t.name,a=t.value;u(Object(j.a)(Object(j.a)({},i),{},Object(U.a)({},n,a)))},d=function(){return i.username?!!i.password||(c("La contrase\xf1a est\xe1 vac\xeda."),!1):(c("El usuario est\xe1 vac\xedo."),!1)};return Object(N.jsxs)("form",{className:"loginForm",children:[Object(N.jsxs)("fieldset",{className:"loginData",children:[Object(N.jsx)("label",{htmlFor:"username",children:"Usuario"}),Object(N.jsx)("input",{className:"usernameInput",type:"text",id:"username",name:"username",value:i.username,onChange:p}),Object(N.jsx)("label",{htmlFor:"password",children:"Contrase\xf1a"}),Object(N.jsx)("input",{className:"passwordInput",type:"password",id:"password",name:"password",value:i.password,onChange:p})]}),Object(N.jsxs)("div",{className:"buttonsDiv",children:[Object(N.jsx)("button",{onClick:function(e){e.preventDefault(),d()&&(n(i),u(Object(j.a)(Object(j.a)({},i),{},{password:""})))},children:" Login "}),Object(N.jsx)("button",{onClick:function(e){e.preventDefault(),d()&&(t(i),u(Object(j.a)(Object(j.a)({},i),{},{password:""})))},children:" Registrarse "})]}),Object(N.jsx)("p",{className:"notification",children:r})]})}n(28);function I(){var e=D(),t=e.userLogged,n=e.userPrefs,r=e.logOutUser,c=e.changeUserPrefs,s=C(),o=s.loadingMessages,i=s.notification,u=s.setNotification,p=s.sendMessage,d=Object(a.useState)({nickname:"",color:"white",message:""}),b=Object(l.a)(d,2),f=b[0],h=b[1],m=function(e){var t=e.target,n=t.name,a=t.value;h(Object(j.a)(Object(j.a)({},f),{},Object(U.a)({},n,a)))},O=function(e){if(e&&e.preventDefault(),!o){if(!f.nickname)return u("No ha ingresado un nickname.");if(!f.message)return u("No ha escrito ning\xfan mensaje.");p(f),h(Object(j.a)(Object(j.a)({},f),{},{message:""})),c(f.nickname,f.color)}};return Object(a.useEffect)((function(){h({nickname:n.nickname,color:n.color,message:""})}),[n]),Object(a.useEffect)((function(){var e=document.querySelector(".colorPicker option[value=".concat(f.color,"]"));e&&(e.selected=!0)}),[f.color]),Object(N.jsxs)("form",{className:"messageForm",onSubmit:O,children:[Object(N.jsxs)("fieldset",{className:"transmiterData",children:[Object(N.jsxs)("div",{className:"nicknameDiv",children:[Object(N.jsx)("label",{htmlFor:"nickname",children:"Nickname"}),Object(N.jsx)("input",{disabled:!t,className:"nicknameInput",type:"text",id:"nickname",name:"nickname",value:f.nickname,onChange:m})]}),Object(N.jsxs)("select",{disabled:!t,className:"colorPicker",name:"color",id:"color",onChange:m,children:[Object(N.jsx)("option",{value:"white",children:"\u26aa"}),Object(N.jsx)("option",{value:"red",children:"\ud83d\udd34"}),Object(N.jsx)("option",{value:"green",children:"\ud83d\udfe2"}),Object(N.jsx)("option",{value:"orange",children:"\ud83d\udfe0"}),Object(N.jsx)("option",{value:"yellow",children:"\ud83d\udfe1"}),Object(N.jsx)("option",{value:"blue",children:"\ud83d\udd35"}),Object(N.jsx)("option",{value:"blueviolet",children:"\ud83d\udfe3"})]})]}),Object(N.jsxs)("fieldset",{children:[Object(N.jsx)("label",{htmlFor:"message",children:" Message "}),Object(N.jsx)("textarea",{disabled:!t,className:"messageArea",cols:"30",rows:"6",id:"message",name:"message",value:f.message,onChange:m,onKeyPress:function(e){13!==(e.which||e.keyCode)||e.shiftKey||(e.preventDefault(),O())}})]}),Object(N.jsxs)("div",{className:"buttonsDiv",children:[Object(N.jsx)("button",{disabled:o||!t,type:"submit",children:"ENVIAR"}),Object(N.jsx)("button",{disabled:o||!t,onClick:function(e){e.preventDefault(),r()},children:"Cerrar Sesi\xf3n"})]}),Object(N.jsx)("p",{className:"notification",children:i})]})}n(29);function L(){return Object(N.jsxs)("div",{className:"formsContainer",children:[Object(N.jsx)(F,{}),Object(N.jsx)(I,{})]})}n(30);function M(e){var t=e.message;return Object(N.jsxs)("div",{className:"message",children:[Object(N.jsx)("label",{className:t.color,children:t.nickname}),Object(N.jsx)("p",{children:t.message})]})}n(31);function A(){var e=C(),t=e.loadingMessages,n=e.messages;return Object(a.useEffect)((function(){var e=document.querySelector(".messagesContainer");e.scrollTo(0,e.scrollHeight)}),[n]),Object(N.jsxs)("div",{className:"messagesContainer",children:[t&&Object(N.jsx)("h3",{children:"Cargando..."}),n&&n.map((function(e){return Object(N.jsx)(M,{message:e},e.id)}))]})}n(32);function T(){return Object(N.jsx)(S,{children:Object(N.jsx)(P,{children:Object(N.jsxs)("div",{className:"chatContainer",children:[Object(N.jsx)("h2",{children:" CHAT "}),Object(N.jsxs)("section",{className:"chatSection",children:[Object(N.jsx)(L,{}),Object(N.jsx)(A,{})]})]})})})}n(33);function B(){return Object(N.jsx)("div",{className:"App",children:Object(N.jsx)(T,{})})}var H=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,36)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};s.a.render(Object(N.jsx)(r.a.StrictMode,{children:Object(N.jsx)(B,{})}),document.getElementById("root")),H()}},[[34,1,2]]]);
//# sourceMappingURL=main.5efb2df5.chunk.js.map