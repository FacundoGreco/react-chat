(this["webpackJsonpprimer-app"]=this["webpackJsonpprimer-app"]||[]).push([[0],{132:function(e,t,n){},141:function(e,t){},143:function(e,t){},153:function(e,t){},155:function(e,t){},180:function(e,t){},182:function(e,t){},183:function(e,t){},188:function(e,t){},190:function(e,t){},196:function(e,t){},198:function(e,t){},217:function(e,t){},229:function(e,t){},232:function(e,t){},236:function(e,t,n){},237:function(e,t,n){},238:function(e,t,n){},239:function(e,t,n){},240:function(e,t,n){},241:function(e,t,n){},242:function(e,t,n){},243:function(e,t,n){"use strict";n.r(t);var a=n(4),r=n.n(a),c=n(125),s=n.n(c),o=(n(132),n(6)),i=n.n(o),u=n(11),l=n(14),p=n(126),d=n(10),f=n(69);n(244);f.a.initializeApp({apiKey:"AIzaSyB3eTixPwzFobVTrmom_vQpOnP3wZ5hkuA",authDomain:"react-chat-9e283.firebaseapp.com",databaseURL:"https://react-chat-9e283-default-rtdb.firebaseio.com",projectId:"react-chat-9e283",storageBucket:"react-chat-9e283.appspot.com",messagingSenderId:"178991264140",appId:"1:178991264140:web:bdfebce71e614ef73626a9"});var j=f.a.firestore(),b=n(134);function h(e){return m.apply(this,arguments)}function m(){return(m=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,j.collection("messages").orderBy("date","asc").onSnapshot((function(e){var n=[];e.forEach((function(e){n.push(Object(d.a)({id:e.id},e.data()))})),t(n)})),e.next=8;break;case 4:throw e.prev=4,e.t0=e.catch(0),console.log(e.t0),new Error("Los mensajes no se pudieron cargar");case 8:case"end":return e.stop()}}),e,null,[[0,4]])})))).apply(this,arguments)}function v(e){return O.apply(this,arguments)}function O(){return(O=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.collection("messages").doc().set(t);case 3:e.next=9;break;case 5:throw e.prev=5,e.t0=e.catch(0),console.log(e.t0),new Error("El mensaje no se pudo enviar.");case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function x(e){return g.apply(this,arguments)}function g(){return(g=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.collection("users").where("username","==",t).get();case 3:return n=e.sent,e.abrupt("return",0===n.docs.length);case 7:throw e.prev=7,e.t0=e.catch(0),console.log(e.t0),new Error("El nombre de usuario no se pudo validar.");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function w(e){return k.apply(this,arguments)}function k(){return(k=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.hash(t.password,8);case 3:return t.password=e.sent,e.next=6,j.collection("users").doc().set(t);case 6:e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(0),console.log(e.t0),new Error("El usuario no se pudo registrar.");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function y(e,t){return N.apply(this,arguments)}function N(){return(N=Object(u.a)(i.a.mark((function e(t,n){var a,r,c,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,a=!1,r=Object(p.a)(t),e.prev=3,r.s();case 5:if((c=r.n()).done){e.next=13;break}return s=c.value,e.next=9,b.compare(n,s.data().password);case 9:if(!e.sent){e.next=11;break}a=Object(d.a)({id:s.id},s.data());case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",a);case 24:throw e.prev=24,e.t1=e.catch(0),console.log(e.t1),new Error("La contrase\xf1a no se pudo validar.");case 28:case"end":return e.stop()}}),e,null,[[0,24],[3,15,18,21]])})))).apply(this,arguments)}function C(e){return E.apply(this,arguments)}function E(){return(E=Object(u.a)(i.a.mark((function e(t){var n,a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,a=t.password,e.prev=1,e.next=4,j.collection("users").where("username","==",n).get();case 4:if(!(r=e.sent).docs){e.next=9;break}return e.abrupt("return",y(r.docs,a));case 9:return e.abrupt("return",!1);case 10:e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(1),console.log(e.t0),new Error("El usuario no se pudo validar.");case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function S(e,t,n){return D.apply(this,arguments)}function D(){return(D=Object(u.a)(i.a.mark((function e(t,n,a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.collection("users").doc(t).update({nickname:n,color:a});case 3:e.next=9;break;case 5:throw e.prev=5,e.t0=e.catch(0),console.log(e.t0),new Error("No se pudieron guardar las preferencias.");case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function P(e){return U.apply(this,arguments)}function U(){return(U=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.collection("messages").doc(t).delete();case 3:e.next=9;break;case 5:throw e.prev=5,e.t0=e.catch(0),console.log(e.t0),new Error("No se pudo eliminar el mensaje.");case 9:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}var L=n(1),F=Object(a.createContext)(),M=function(){return Object(a.useContext)(F)};function I(e){var t=e.children,n=Object(a.useState)(!0),r=Object(l.a)(n,2),c=r[0],s=r[1],o=Object(a.useState)([]),p=Object(l.a)(o,2),d=p[0],f=p[1],j=Object(a.useState)(""),b=Object(l.a)(j,2),m=b[0],O=b[1],x=function(){var e=Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h(f);case 3:setTimeout((function(){s(!1)}),500),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0),O(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(""),n={date:new Date,nickname:t.nickname,color:t.color,message:t.message},e.prev=2,e.next=5,v(n);case 5:O("Mensaje enviado"),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0),O(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(""),e.prev=1,e.next=4,P(t);case 4:O("Mensaje eliminado."),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),O("No se pudo eliminar el mensaje.");case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){x()}),[]),Object(L.jsx)(F.Provider,{value:{loadingMessages:c,messages:d,notification:m,setNotification:O,sendMessage:g,deleteMessage:w},children:t})}var A=Object(a.createContext)(),T=function(){return Object(a.useContext)(A)};function B(e){var t=e.children,n=Object(a.useState)(""),r=Object(l.a)(n,2),c=r[0],s=r[1],o=Object(a.useState)(!1),p=Object(l.a)(o,2),f=p[0],j=p[1],b=Object(a.useState)(!1),h=Object(l.a)(b,2),m=h[0],v=h[1],O=Object(a.useState)({id:"",nickname:"",color:"white"}),g=Object(l.a)(O,2),k=g[0],y=g[1],N=function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(""),j(!1),e.prev=2,e.next=5,x(t.username);case 5:if(!e.sent){e.next=11;break}return e.next=8,w(Object(d.a)(Object(d.a)({},t),{},{nickname:"",color:"white"}));case 8:s("Usuario creado. Logueate!"),e.next=12;break;case 11:s("Usuario no disponible.");case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),s(e.t0.message);case 17:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(""),j(!1),e.prev=2,e.next=5,C(t);case 5:(n=e.sent)?(y({id:n.id,nickname:n.nickname,color:n.color}),j(!0),v(!0===n.admin),s("Has iniciado sesi\xf3n!")):s("Usuario o contrase\xf1a incorrecto/s."),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),s(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(u.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S(k.id,t,n);case 3:y({nickname:t,color:n}),s(""),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),s("No se pudieron guardar las preferencias.");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(L.jsx)(A.Provider,{value:{notification:c,setNotification:s,registerUser:N,loginUser:E,userLogged:f,adminLogged:m,userPrefs:k,logOutUser:function(){j(!1),y({id:"",nickname:"",color:"white"}),s("Ha cerrado sesi\xf3n.")},changeUserPrefs:D},children:t})}var z=n(33);n(236);function H(){var e=T(),t=e.registerUser,n=e.loginUser,r=e.notification,c=e.setNotification,s=Object(a.useState)({username:"",password:""}),o=Object(l.a)(s,2),i=o[0],u=o[1],p=function(e){var t=e.target,n=t.name,a=t.value;u(Object(d.a)(Object(d.a)({},i),{},Object(z.a)({},n,a)))},f=function(){return i.username?!!i.password||(c("La contrase\xf1a est\xe1 vac\xeda."),!1):(c("El usuario est\xe1 vac\xedo."),!1)};return Object(L.jsxs)("form",{className:"loginForm",children:[Object(L.jsxs)("fieldset",{className:"loginData",children:[Object(L.jsx)("label",{htmlFor:"username",children:"Usuario"}),Object(L.jsx)("input",{className:"usernameInput",type:"text",id:"username",name:"username",value:i.username,onChange:p}),Object(L.jsx)("label",{htmlFor:"password",children:"Contrase\xf1a"}),Object(L.jsx)("input",{className:"passwordInput",type:"password",id:"password",name:"password",value:i.password,onChange:p})]}),Object(L.jsxs)("div",{className:"buttonsDiv",children:[Object(L.jsx)("button",{onClick:function(e){e.preventDefault(),f()&&(n(i),u(Object(d.a)(Object(d.a)({},i),{},{password:""})))},children:" Login "}),Object(L.jsx)("button",{onClick:function(e){e.preventDefault(),f()&&(t(i),u(Object(d.a)(Object(d.a)({},i),{},{password:""})))},children:" Registrarse "})]}),Object(L.jsx)("p",{className:"notification",children:r})]})}n(237);function K(){var e=T(),t=e.userLogged,n=e.userPrefs,r=e.logOutUser,c=e.changeUserPrefs,s=M(),o=s.loadingMessages,i=s.notification,u=s.setNotification,p=s.sendMessage,f=Object(a.useState)({nickname:"",color:"white",message:""}),j=Object(l.a)(f,2),b=j[0],h=j[1],m=function(e){var t=e.target,n=t.name,a=t.value;h(Object(d.a)(Object(d.a)({},b),{},Object(z.a)({},n,a)))},v=function(e){if(e&&e.preventDefault(),!o){if(!b.nickname)return u("No ha ingresado un nickname.");if(!b.message)return u("No ha escrito ning\xfan mensaje.");p(b),h(Object(d.a)(Object(d.a)({},b),{},{message:""})),c(b.nickname,b.color)}};return Object(a.useEffect)((function(){h({nickname:n.nickname,color:n.color,message:""})}),[n]),Object(a.useEffect)((function(){var e=document.querySelector(".colorPicker option[value=".concat(b.color,"]"));e&&(e.selected=!0)}),[b.color]),Object(L.jsxs)("form",{className:"messageForm",onSubmit:v,children:[Object(L.jsxs)("fieldset",{className:"transmiterData",children:[Object(L.jsxs)("div",{className:"nicknameDiv",children:[Object(L.jsx)("label",{htmlFor:"nickname",children:"Nickname"}),Object(L.jsx)("input",{disabled:!t,className:"nicknameInput",type:"text",id:"nickname",name:"nickname",value:b.nickname,onChange:m})]}),Object(L.jsxs)("select",{disabled:!t,className:"colorPicker",name:"color",id:"color",onChange:m,children:[Object(L.jsx)("option",{value:"white",children:"\u26aa"}),Object(L.jsx)("option",{value:"red",children:"\ud83d\udd34"}),Object(L.jsx)("option",{value:"green",children:"\ud83d\udfe2"}),Object(L.jsx)("option",{value:"orange",children:"\ud83d\udfe0"}),Object(L.jsx)("option",{value:"yellow",children:"\ud83d\udfe1"}),Object(L.jsx)("option",{value:"blue",children:"\ud83d\udd35"}),Object(L.jsx)("option",{value:"blueviolet",children:"\ud83d\udfe3"})]})]}),Object(L.jsxs)("fieldset",{children:[Object(L.jsx)("label",{htmlFor:"message",children:" Message "}),Object(L.jsx)("textarea",{disabled:!t,className:"messageArea",cols:"30",rows:"6",id:"message",name:"message",value:b.message,onChange:m,onKeyPress:function(e){13!==(e.which||e.keyCode)||e.shiftKey||(e.preventDefault(),v())}})]}),Object(L.jsxs)("div",{className:"buttonsDiv",children:[Object(L.jsx)("button",{disabled:o||!t,type:"submit",children:"ENVIAR"}),Object(L.jsx)("button",{disabled:o||!t,onClick:function(e){e.preventDefault(),r()},children:"Cerrar Sesi\xf3n"})]}),Object(L.jsx)("p",{className:"notification",children:i})]})}n(238);function R(){return Object(L.jsxs)("div",{className:"formsContainer",children:[Object(L.jsx)(H,{}),Object(L.jsx)(K,{})]})}var q=n(127);n(239);function J(e){var t=e.message,n=e.displayDelete,a=e.handleDelete;return Object(L.jsxs)("div",{className:"message",children:[Object(L.jsx)("label",{className:t.color,children:t.nickname}),n&&Object(L.jsx)(q.a,{className:"deleteButton",size:"25px",color:"white",onClick:function(){a(t.id)}}),Object(L.jsx)("p",{children:t.message})]})}n(240);function V(){var e=M(),t=e.loadingMessages,n=e.messages,r=e.deleteMessage,c=T().adminLogged,s=function(e){c&&r(e)};return Object(a.useEffect)((function(){var e=document.querySelector(".messagesContainer");e.scrollTo(0,e.scrollHeight)}),[n]),Object(L.jsxs)("div",{className:"messagesContainer",children:[t&&Object(L.jsx)("h3",{children:"Cargando..."}),n&&n.map((function(e){return Object(L.jsx)(J,{message:e,displayDelete:c,handleDelete:s},e.id)}))]})}n(241);function Q(){return Object(L.jsx)(I,{children:Object(L.jsx)(B,{children:Object(L.jsxs)("div",{className:"chatContainer",children:[Object(L.jsx)("h2",{children:" CHAT "}),Object(L.jsxs)("section",{className:"chatSection",children:[Object(L.jsx)(R,{}),Object(L.jsx)(V,{})]})]})})})}n(242);function Z(){return Object(L.jsx)("div",{className:"App",children:Object(L.jsx)(Q,{})})}var _=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,245)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};s.a.render(Object(L.jsx)(r.a.StrictMode,{children:Object(L.jsx)(Z,{})}),document.getElementById("root")),_()}},[[243,1,2]]]);
//# sourceMappingURL=main.feee2a96.chunk.js.map